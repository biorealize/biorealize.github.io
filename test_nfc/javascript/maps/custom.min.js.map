{"version":3,"sources":["custom.js"],"names":["pubnub","PubNub","subscribeKey","publishKey","jQuery","document","ready","$","subscribe","channels","addListener","message","m","channelName","channel","console","log","append","JSON","stringify","click","e","$this","currentTarget","is","attr","show","hide","switchPlate","filter","i","d","find","eq","focus","plate","val","change","submit","preventDefault","experiment","fields","length","peripheral_type","load","each","row","chr","String","fromCharCode","j","td","$c","sealed","syringe","sendTag","t","config","window","location","hostname","apiUrl","tagObj","cmnd","data","publish","meta","getMeta","uuid","getUUID","v"],"mappings":"AAAA,aAEA,IAAAA,OAAA,IAAAC,OAAA,CACAC,aAAA,6CACAC,WAAA,+CAEAC,OAAAC,UAAAC,MAAA,SAAAC,GACAP,OAAAQ,UAAA,CACAC,SAAA,CAAA,oBAEAT,OAAAU,YAAA,CACAC,QAAA,SAAAC,GACA,IAAAC,EAAAD,EAAAE,QACAC,QAAAC,IAAA,oBAAAJ,GACAG,QAAAC,IAAAH,GAEAN,EAAA,QAAAU,OAAA,MAAAC,KAAAC,UAAAP,EAAAD,SAAA,WAGAJ,EAAA,0BAAAa,MAAA,SAAAC,GACA,IAAAC,EAAAf,EAAAc,EAAAE,eAEAD,EAAAE,GAAA,cACA,oBAAAF,EAAAG,KAAA,OACAlB,EAAA,uCAAAmB,OACAnB,EAAA,kBAAAoB,OACAC,IACArB,EAAA,UAAAsB,OAAA,SAAAC,EAAAC,GACA,OAAAxB,EAAAwB,GAAAP,GAAA,cAEAQ,KAAA,SAAAC,GAAA,GAAAC,UAEA3B,EAAA,wDAAAoB,OACApB,EAAA,kBAAAmB,WAKA,IAAAE,EAAA,WAGA,GAFArB,EAAA,mBAAAoB,OAEApB,EAAA,qBAAAiB,GAAA,YAAA,CACA,IAAAW,EAAA5B,EAAA,oBAAA6B,MACA7B,EAAA,IAAA4B,GAAAT,SAIAnB,EAAA,oBAAA8B,OAAAT,GAAAS,SACA9B,EAAA,oBAAA+B,OAAA,SAAAjB,GACAA,EAAAkB,iBAKA,IAJA,IAAAC,EAAA,GACAlB,EAAAf,EAAAc,EAAAE,eACAkB,EAAA,CAAA,KAAA,SAAA,WAAA,aAAA,WAAA,qBAAA,qBAEAX,EAAA,EAAAA,EAAAW,EAAAC,OAAAZ,IACAU,EAAAC,EAAAX,IAAAR,EAAAU,KAAA,IAAAS,EAAAX,IAAAM,MAGA,GAAA,SAAAd,EAAAU,KAAA,kCAAAI,MAAA,CACAI,EAAAG,gBAAArB,EAAAU,KAAA,oBAAAI,MACA,IAAAQ,EAAA,GACAtB,EAAAU,KAAA,2BAAAA,KAAA,SACAA,KAAA,MAAAa,KAAA,SAAAf,EAAAgB,GACA,IAAAC,EAAAC,OAAAC,aAAA,GAAAnB,GACAvB,EAAAuC,GAAAd,KAAA,MAAAa,KAAA,SAAAK,EAAAC,GACAP,EAAAG,EAAAG,GAAA3C,EAAA4C,GAAAnB,KAAA,oBAAAI,UAGAI,EAAAI,KAAAA,EACAQ,GAAA9B,EAAAU,KAAA,8BAAAI,OACAI,EAAAa,OAAA,QAAA/B,EAAAU,KAAA,8BAAAI,WAEAI,EAAAc,QAAAhC,EAAAU,KAAA,YAAAI,MAGA7B,EAAA,cAAA6B,IAAAlB,KAAAC,UAAAqB,IACAe,QAAAf,OAIA,IAAAY,GAAA,SAAAI,GACAzC,QAAAC,IAAAwC,IAGAC,OAAA,WACA,IAAAA,EAAA,GASA,MAPA,IAAAC,OAAAC,SAAAC,SAEAH,EAAAI,OAAA,wBAEAJ,EAAAI,OAAA,2BAGAJ,GAGAF,QAAA,SAAAO,GACA,IAAAnD,EAAA,CACAoD,KAAA,UACAC,KAAAF,GAEA9D,OAAAiE,QAAA,CACAtD,QAAAA,EACAG,QAAA,SACAoD,KAAAC,aAIAA,QAAA,WACA,MAAA,CACAC,KAAApE,OAAAqE,UACAC,EAAA","file":"../custom.min.js","sourcesContent":["\"use strict\";\n\nvar pubnub = new PubNub({\n  subscribeKey: \"sub-c-0b2aaa44-a779-11e6-be20-0619f8945a4f\",\n  publishKey: \"pub-c-722b1270-6c2b-423d-98f6-cb21c18a2265\"\n});\njQuery(document).ready(function ($) {\n  pubnub.subscribe({\n    channels: ['NFC_TAG_CLIENT']\n  });\n  pubnub.addListener({\n    message: function message(m) {\n      var channelName = m.channel;\n      console.log('message came in: ', m);\n      console.log(channelName); //$('#log').innerHTML(JSON.stringify(m.message))\n\n      $('#log').append('<p>' + JSON.stringify(m.message) + '</p>');\n    }\n  });\n  $('input[name=media_type]').click(function (e) {\n    var $this = $(e.currentTarget);\n\n    if ($this.is(':checked')) {\n      if ($this.attr('id') == 'media_type_solid') {\n        $('#peripheral_type_group, #sealed_row').show();\n        $('#syringe_group').hide();\n        switchPlate();\n        var table = $('.plate').filter(function (i, d) {\n          return $(d).is(':visible');\n        });\n        table.find('input').eq(0).focus(); //$('.plate').is(':visible').find('input').eq(0).focus()\n      } else {\n        $('#peripheral_type_group, .form-row.plate, #sealed_row').hide();\n        $('#syringe_group').show();\n      }\n    }\n  });\n\n  var switchPlate = function switchPlate() {\n    $('.form-row.plate').hide();\n\n    if ($('#media_type_solid').is(':checked')) {\n      var plate = $('#peripheral_type').val();\n      $('#' + plate).show();\n    }\n  };\n\n  $('#peripheral_type').change(switchPlate).change();\n  $('#submit_nfc_form').submit(function (e) {\n    e.preventDefault();\n    var experiment = {};\n    var $this = $(e.currentTarget);\n    var fields = ['id', 'client', 'location', 'start_time', 'duration', 'target_temperature', 'imaging_frequency'];\n\n    for (var i = 0; i < fields.length; i++) {\n      experiment[fields[i]] = $this.find('#' + fields[i]).val();\n    }\n\n    if ($this.find('input[name=media_type]:checked').val() == 'solid') {\n      experiment.peripheral_type = $this.find('#peripheral_type').val();\n      var load = {};\n      var $plate = $this.find('.form-row.plate:visible').find('table');\n      $plate.find('tr').each(function (i, row) {\n        var chr = String.fromCharCode(65 + i);\n        $(row).find('td').each(function (j, td) {\n          load[chr + j] = $(td).find('input[type=text]').val();\n        });\n      });\n      experiment.load = load;\n      $c($this.find('input[name=sealed]:checked').val());\n      experiment.sealed = $this.find('input[name=sealed]:checked').val() == 'true';\n    } else {\n      experiment.syringe = $this.find('#syringe').val();\n    }\n\n    $('#json_sent').val(JSON.stringify(experiment));\n    sendTag(experiment);\n  });\n});\n\nvar $c = function $c(t) {\n  console.log(t);\n};\n\nvar config = function config() {\n  var config = {};\n\n  if (window.location.hostname == '') {\n    //this is for local testing with local MongoDB\n    config.apiUrl = 'http://localhost:4001';\n  } else {\n    config.apiUrl = 'http://18.191.34.33:4000';\n  }\n\n  return config;\n};\n\nvar sendTag = function sendTag(tagObj) {\n  var message = {\n    cmnd: 'ADD_NFC',\n    data: tagObj\n  };\n  pubnub.publish({\n    message: message,\n    channel: 'SERVER',\n    meta: getMeta()\n  });\n};\n\nvar getMeta = function getMeta() {\n  return {\n    'uuid': pubnub.getUUID(),\n    'v': 1\n  };\n};\n/*\n{ \"experiment\" :\n\t{\n\tid: 79E4464,\n\t\"client\" : \"Lacolombe\",\n\t\"location\" : 19102,\n\t\"start_time:\" : Monday08April2019_09/37/28AM,\n\t\"duration\" : 3600,\n\t\"peripheral_type\" : \"6_well_plate\",\n\t\"load\":\n\t     [\n{\n\t\t\"A1\" : organismA\",\n\t\t\"A2\" : organismB\",\n\t\t\"A3\" : organismC\",\n\t\t\"B1\" : organismD\",\n\t\t\"B2\" : organismE\",\n\t\t\"B3\" : organismF\",  \n\t\t}\n     ],\n\t\"target_temperature\" : 37,\n\t\"imaging_frequency\" : 3600,\n\t\"end_time\": <filled when completed>\n\t}\n}\n*/"]}