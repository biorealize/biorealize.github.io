<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>lesson 2</title>
  <script type="text/javascript" src="http://pubnub.github.io/eon/v/eon/1.0.0/eon.js"></script>
  <link type="text/css" rel="stylesheet" href="http://pubnub.github.io/eon/v/eon/1.0.0/eon.css" />
  <style type="text/css">
    html, body { margin: 0; padding:0 }
    #chart {
      left: 300;
      right: 200;
      display: flex;
      align-items: center;
    }
    #temp, #light, #pot {
      flex: 1;
      margin: 20px;
    }
  </style>
</head>
<body>

<div id="chart">
  <div id="light"></div>
  <div id="temp"></div>
  <div id="pot"></div>
</div>
 <script type="text/javascript">

    var pubnub = new PubNub({

        subscribeKey: "sub-c-0b2aaa44-a779-11e6-be20-0619f8945a4f",
        publishKey: "pub-c-722b1270-6c2b-423d-98f6-cb21c18a2265",
        
        });
        
        pubnub.addListener({

        message: function (message) {
        console.log('message came in: ', message)
        }
        });

        var __eon_pubnub = new PubNub({
            subscribeKey: "sub-c-0b2aaa44-a779-11e6-be20-0619f8945a4f"
        });
        var __eon_cols = ["Temperature","New York","San Francisco","Portland"]; 
        var __eon_labels = {}; 
        chart = eon.chart({
            pubnub: __eon_pubnub,
            channels: ["node-red"],
            history: false,
            flow: true,
            rate: 1000,
            limit: 5,
            generate: {
                bindto: "#chart",
                data: {
                    colors: {"Austin":"#D70060","New York":"#E54028","San Francisco":"#F18D05","Portland":"#113F8C"},
                    type: "spline"
                },
                transition: {
                    duration: 250
                },
                axis: {
                    x: {
                        label: ""
                    },
                    y: {
                        label: ""
                    }
                },
                grid: {
                    x: {
                        show: false 
                    },
                    y: {
                        show: false 
                    }
                },
                tooltip: {
                 show: true
                },
                point: {
                    show: true
                }
            },
            transform: function(message) {
                var message = eon.c.flatten(message.eon);
                var o = {};
                for(index in message) {
                    if(__eon_cols.indexOf(index) > -1){
                        o[__eon_labels[index] || index] = message[index];
                    }
                }
                return {
                    eon: o
                };
            }
        });

  
    </script>   
</body>
</html>